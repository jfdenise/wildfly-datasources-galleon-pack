<?xml version="1.0" ?>
<layer-spec xmlns="urn:jboss:galleon:layer-spec:1.0" name="postgresql-default-datasource">
    <props>
        <prop name="add-on" value="database,postgresql:default"/>
        <prop name="add-on-description" value="To configure the postgresql datasource, check the documentation in https://github.com/wildfly-extras/wildfly-datasources-galleon-pack/blob/main/doc/postgresql/README.md"/>
        <prop name="add-on-fix-no-default-datasource" value="Required env variables,POSTGRESQL_DATABASE=&lt;database name&gt; POSTGRESQL_USER=&lt;user&gt; POSTGRESQL_PASSWORD=&lt;password&gt;"/>
        <prop name="bring-datasource" value="###DEFAULT_DS###"/>
        <prop name="add-on-depends-on" value="only:datasources"/>
    </props>
    <dependencies>
        <layer name="datasources"/>
        <layer name="postgresql-datasource"/>
    </dependencies>
    
    <feature spec="subsystem.ee.service.default-bindings">
        <param name="datasource" value="${org.wildfly.datasources.postgresql.jndi-name,env.POSTGRESQL_JNDI:java:jboss/datasources/${org.wildfly.datasources.postgresql.datasource, env.POSTGRESQL_DATASOURCE,env.OPENSHIFT_POSTGRESQL_DATASOURCE:PostgreSQLDS}}"/>
    </feature>
</layer-spec>

